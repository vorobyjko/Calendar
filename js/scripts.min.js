var Calendar=function(a){function b(){var a,b,c,d=5,e=0,a=document.getElementById(m);if(!a)throw new Error("Element with given id "+m+" does not exist!");l=document.createElement("table"),l.id="calendarTable",a.appendChild(l);for(var f=1;d>=f;f++){b=document.createElement("tr"),l.appendChild(b);for(var g=1;g<=i.length;g++)e++,c=document.createElement("td"),c.width=parseInt(a.clientWidth/i.length),c.height=c.width,l.lastChild.appendChild(c)}}function c(){var a="<div class='todayWrapper'><div id='prevBtn'>&#9666;</div><div id='year'>"+j[o]+" "+k+"</div><div id='nextBtn'>&#x25b8;</div><div id='today'>Сегодня</div></div>";document.getElementById(m).innerHTML+=a}function d(a,b){for(var c=31,d=0,e=l.querySelectorAll("td"),g=h.daysInMonth(a),j=h.daysInMonth(a-1),k=0;k<e.length;k++)b&&(e[k].innerHTML="",e[k].className="",h.setMonth(a)),k<i.length&&(e[k].innerHTML=i[k]+", "),k>=4?(e[k].innerHTML+=g[d++]||1,e[k].setAttribute("id",d+"-"+a),g[d]===h.getDate()&&(e[k+1].className=h.getMonth()===o?"todayHighlidth":"")):(j=j.slice(-e.length+c),e[k].innerHTML+=j[k],e[k].setAttribute("id",j[k]+"-"+Number(a-1)));f(n)}function e(a){var b=document.getElementById("prevBtn"),c=document.getElementById("nextBtn"),e=function(a){var b=this.id||a.srcElement.id,c="prevBtn"===b?h.getMonth()-1:h.getMonth()+1;d(c,!0),document.getElementById("year").innerHTML=j[h.getMonth()]+" "+k};a?(b.removeEventListener("click",e),c.removeEventListener("click",e)):(b.addEventListener("click",e),c.addEventListener("click",e))}function f(a){var b="<p id='eventTitle'></p><p id='eventDescription'></p>";a instanceof Array||(a[0]=[a[0]]);for(var c=0;c<a.length;c++){var d=a[c].date.split(".")[0],e=a[c].date.split(".")[1]-1,f=d+"-"+e,g=document.getElementById(f);null!==g&&(g.className="addedEvent",g.innerHTML+=b,g.querySelector("#eventTitle").innerHTML+=a[c].eventTitle,g.lastChild.innerHTML+=a[c].eventDescription)}}function g(){var a=function(a){for(var b=l.querySelectorAll("td"),c=0;c<b.length;c++)b[c].width=parseInt(p.getCalendarEl().parentNode.clientWidth/i.length),b[c].height=b[c].width};window.addEventListener?window.addEventListener("resize",a):window.onresize=a}var h=new Date,i=["Понедельник","Вторник","Среда","Четверг","Пятница","Суббота","Воскресенье"],j=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],k=h.getFullYear();Date.hasOwnProperty("daysInMonth")||(Date.prototype.daysInMonth=function(a){for(var b=33-new Date(this.getFullYear(),a||this.getMonth(),33).getDate(),c=[],d=1;b>=d;d++)c.push(d);return c});var l,m=a.renderTo||{},n=a.setEvents||[],o=h.getMonth(),p=this;Calendar.prototype.addEvent=function(){if(n&&n instanceof Array)for(var a=0;a<arguments.length;a++)n.push(arguments[a]);f(n)},Calendar.prototype.getEvents=function(){return n},Calendar.prototype.getCalendarEl=function(){return l},Calendar.prototype.destroy=function(){l.parentNode.removeChild(l),e(!0)},c(),b(),d(h.getMonth()),e(),g()},FUNCTIONS_COLLECTION=[],initAll=function(a){if(a instanceof Array)for(var b=a.length-1;b>=0;b--)"function"==typeof a[b]&&a[b]()},crossBrowserEventListener=function(){"undefined"==typeof Element.prototype.addEventListener&&(Element.prototype.addEventListener=function(a,b){return a="on"+a,this.attachEvent(a,b)})},inputSearchValue=function(){var a,b;b=document.getElementById("search"),b.addEventListener("focus",function(b){a=this.placeholder,this.placeholder=""}),b.addEventListener("blur",function(b){0===this.placeholder.length&&(this.placeholder=a)})},calendar=new Calendar({renderTo:"calendarWrapper",setEvents:[{date:"9.5.2015",eventTitle:"Напиться",eventDescription:"Витя Костин, Петр Михайлов"},{date:"22.5.2015",eventTitle:"ДР!",eventDescription:"Дима Молодцов"},{date:"15.6.2015",eventTitle:"Summer Party",eventDescription:"Fucking awesome party"}]});FUNCTIONS_COLLECTION.push(inputSearchValue,crossBrowserEventListener),initAll(FUNCTIONS_COLLECTION);